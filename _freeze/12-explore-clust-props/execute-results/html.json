{
  "hash": "21778fab4262611848a2f77fd37e7177",
  "result": {
    "markdown": "# Explore clusters {#sec-clust-full}\n\nBased on the model metrics in @sec-mod-metrics , k = 4, 6, or 9 seem like reasonable places to start.\nThese are local maxima in the average silhouette metric.\nFor the Calinski-Harabasz index, we see a steady decrease from 2-7, then similar index values for 7-9, then decreasing again.\nIn general higher is better, which would suggest something in the lower range.\nReally don't have a clear elbow in the WSS plot, I could see an argument for the 8-11 region being where it starts to flatten out more.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(workflows)\nlibrary(parsnip)\nlibrary(tidyverse)\nlibrary(tidymodels)\nlibrary(glue)\nlibrary(tidyclust)\nlibrary(scales)\nlibrary(GGally) # for ggparcoor\nlibrary(gganimate)\nlibrary(ggradar)\nlibrary(ggrepel)\nlibrary(patchwork)\nlibrary(tidytext)\nlibrary(gtsummary)\n\n# our fitted models, created in chap 11\nload(\"data/fitted_kmeans_mods.RData\")\n\n# mukeys, cluster assignments, and soil properties \n# note these are the untransformed soil prop values\nprop <- read_csv(\"data/mukey_cluster_assignments_and_soilprops.csv\")\n```\n:::\n\n\n## Extract Centroids\n\nRecall that these are still the standardized values.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncent_df <- mods %>% \n  mutate(centroids = map(km_fit, ~extract_centroids(.x))) %>% \n  select(n_clust, centroids) %>% \n  unnest(centroids) # debated whether to also rescale here, as I did below for the radar plots? \n\n\nhead(cent_df)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"n_clust\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\".cluster\"],\"name\":[2],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"claytotal\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"om\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"cec7\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"dbthirdbar\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"ec\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"ph1to1h2o\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"caco3\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"lep\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"ksat\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"awc\"],\"name\":[12],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"2\",\"2\":\"Cluster_1\",\"3\":\"-1.0390212\",\"4\":\"-0.7690860\",\"5\":\"-1.0101470\",\"6\":\"0.7588767\",\"7\":\"-0.1955766\",\"8\":\"-0.5552919\",\"9\":\"-0.4721513\",\"10\":\"-0.8125267\",\"11\":\"0.9888608\",\"12\":\"-0.9687257\"},{\"1\":\"2\",\"2\":\"Cluster_2\",\"3\":\"0.5382162\",\"4\":\"0.3983889\",\"5\":\"0.5232592\",\"6\":\"-0.3931005\",\"7\":\"0.1013093\",\"8\":\"0.2876429\",\"9\":\"0.2445758\",\"10\":\"0.4208914\",\"11\":\"-0.5122330\",\"12\":\"0.5018029\"},{\"1\":\"3\",\"2\":\"Cluster_1\",\"3\":\"-1.1090486\",\"4\":\"-0.8350427\",\"5\":\"-1.0919031\",\"6\":\"0.8305072\",\"7\":\"-0.2304595\",\"8\":\"-0.6060815\",\"9\":\"-0.5181838\",\"10\":\"-0.7962464\",\"11\":\"1.0771030\",\"12\":\"-1.1153142\"},{\"1\":\"3\",\"2\":\"Cluster_2\",\"3\":\"0.4982188\",\"4\":\"0.3026695\",\"5\":\"0.5234842\",\"6\":\"-0.3452295\",\"7\":\"-0.1533887\",\"8\":\"-0.3513140\",\"9\":\"-0.5511171\",\"10\":\"0.3595311\",\"11\":\"-0.5256609\",\"12\":\"0.5661619\"},{\"1\":\"3\",\"2\":\"Cluster_3\",\"3\":\"0.4574641\",\"4\":\"0.4624978\",\"5\":\"0.3966768\",\"6\":\"-0.3879633\",\"7\":\"0.5136638\",\"8\":\"1.2660200\",\"9\":\"1.4909717\",\"10\":\"0.3254523\",\"11\":\"-0.3761927\",\"12\":\"0.3539332\"},{\"1\":\"4\",\"2\":\"Cluster_1\",\"3\":\"0.4574235\",\"4\":\"0.3065871\",\"5\":\"0.5016407\",\"6\":\"-0.3484024\",\"7\":\"-0.2565083\",\"8\":\"-0.4037959\",\"9\":\"-0.6127389\",\"10\":\"0.2825014\",\"11\":\"-0.4939956\",\"12\":\"0.5762512\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n# scaled 0-1 for radar plot\nsc_cent <- cent_df %>% \n  mutate(across(.cols = c(3:12),\n                   .fns = ~round(rescale(.x,to = c(0,1)), 1)))\n```\n:::\n\n\n## About individual clusters\n\nWe can also extract information about how many members (unique MUKEYs) have been allocated to each cluster, and the sum of squared error **within** each cluster.\nThis tells us about how how \"cohesive\" each cluster is (lower SSE means points are closer to their cluster centroid, more tightly packed).\n\n\n::: {.cell}\n\n```{.r .cell-code}\niclust <- mods %>% \n  mutate(clust_stat = map(km_fit, ~within_cluster_sse(.x))) %>% \n  select(n_clust, clust_stat) %>% \n  unnest(clust_stat) %>% \n  mutate(.cluster = str_replace_all(.cluster, \"er_\", \"\"))\n\nhead(iclust)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"n_clust\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\".cluster\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"wss\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"n_members\"],\"name\":[4],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"2\",\"2\":\"Clust1\",\"3\":\"13314.76\",\"4\":\"2345\"},{\"1\":\"2\",\"2\":\"Clust2\",\"3\":\"32565.53\",\"4\":\"4527\"},{\"1\":\"3\",\"2\":\"Clust1\",\"3\":\"10395.55\",\"4\":\"2084\"},{\"1\":\"3\",\"2\":\"Clust2\",\"3\":\"14057.82\",\"4\":\"2967\"},{\"1\":\"3\",\"2\":\"Clust3\",\"3\":\"13427.21\",\"4\":\"1821\"},{\"1\":\"4\",\"2\":\"Clust1\",\"3\":\"12567.18\",\"4\":\"2762\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n## Cluster Stats Overall\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](12-explore-clust-props_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](12-explore-clust-props_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](12-explore-clust-props_files/figure-html/unnamed-chunk-3-3.png){width=672}\n:::\n:::\n\n\n## 2 Clusters \"Split the difference\"\n\n-   Cluster 1: sandy, high Ksat and low AWC. Low OM and clay.\n-   Cluster 2: high clay, CEC, OM, AWC, LEP.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoord2 <- parcoor_plot(nclust = 2)\nstat2 <- plot_cluster_stats(2)\n\ncoord2 + stat2 + plot_layout(widths = c(2,1), guides = \"collect\")\n```\n\n::: {.cell-output-display}\n![](12-explore-clust-props_files/figure-html/pc2-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncreate_summary_table(\"k_2\")\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"vhhorvzabt\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#vhhorvzabt .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#vhhorvzabt .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#vhhorvzabt .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#vhhorvzabt .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#vhhorvzabt .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#vhhorvzabt .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#vhhorvzabt .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#vhhorvzabt .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#vhhorvzabt .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#vhhorvzabt .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#vhhorvzabt .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#vhhorvzabt .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#vhhorvzabt .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#vhhorvzabt .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#vhhorvzabt .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#vhhorvzabt .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#vhhorvzabt .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vhhorvzabt .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#vhhorvzabt .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#vhhorvzabt .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vhhorvzabt .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#vhhorvzabt .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#vhhorvzabt .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#vhhorvzabt .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vhhorvzabt .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#vhhorvzabt .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#vhhorvzabt .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#vhhorvzabt .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#vhhorvzabt .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vhhorvzabt .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#vhhorvzabt .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vhhorvzabt .gt_left {\n  text-align: left;\n}\n\n#vhhorvzabt .gt_center {\n  text-align: center;\n}\n\n#vhhorvzabt .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#vhhorvzabt .gt_font_normal {\n  font-weight: normal;\n}\n\n#vhhorvzabt .gt_font_bold {\n  font-weight: bold;\n}\n\n#vhhorvzabt .gt_font_italic {\n  font-style: italic;\n}\n\n#vhhorvzabt .gt_super {\n  font-size: 65%;\n}\n\n#vhhorvzabt .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#vhhorvzabt .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#vhhorvzabt .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#vhhorvzabt .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#vhhorvzabt .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#vhhorvzabt .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#vhhorvzabt .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\">\n  \n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\"><strong>Characteristic</strong></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\"><strong>Cluster_1</strong>, N = 2,345<sup class=\"gt_footnote_marks\">1</sup></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\"><strong>Cluster_2</strong>, N = 4,527<sup class=\"gt_footnote_marks\">1</sup></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td class=\"gt_row gt_left\">claytotal</td>\n<td class=\"gt_row gt_center\">10 (4)</td>\n<td class=\"gt_row gt_center\">25 (8)</td></tr>\n    <tr><td class=\"gt_row gt_left\">om</td>\n<td class=\"gt_row gt_center\">2.40 (1.30)</td>\n<td class=\"gt_row gt_center\">5.84 (8.29)</td></tr>\n    <tr><td class=\"gt_row gt_left\">cec7</td>\n<td class=\"gt_row gt_center\">10 (4)</td>\n<td class=\"gt_row gt_center\">24 (16)</td></tr>\n    <tr><td class=\"gt_row gt_left\">dbthirdbar</td>\n<td class=\"gt_row gt_center\">1.46 (0.10)</td>\n<td class=\"gt_row gt_center\">1.30 (0.19)</td></tr>\n    <tr><td class=\"gt_row gt_left\">ec</td>\n<td class=\"gt_row gt_center\">0.02 (0.19)</td>\n<td class=\"gt_row gt_center\">0.13 (0.42)</td></tr>\n    <tr><td class=\"gt_row gt_left\">ph1to1h2o</td>\n<td class=\"gt_row gt_center\">6.50 (0.51)</td>\n<td class=\"gt_row gt_center\">7.01 (0.58)</td></tr>\n    <tr><td class=\"gt_row gt_left\">caco3</td>\n<td class=\"gt_row gt_center\">0.7 (2.1)</td>\n<td class=\"gt_row gt_center\">4.0 (5.7)</td></tr>\n    <tr><td class=\"gt_row gt_left\">lep</td>\n<td class=\"gt_row gt_center\">1.18 (0.50)</td>\n<td class=\"gt_row gt_center\">3.08 (1.92)</td></tr>\n    <tr><td class=\"gt_row gt_left\">ksat</td>\n<td class=\"gt_row gt_center\">48 (36)</td>\n<td class=\"gt_row gt_center\">9 (7)</td></tr>\n    <tr><td class=\"gt_row gt_left\">awc</td>\n<td class=\"gt_row gt_center\">0.14 (0.04)</td>\n<td class=\"gt_row gt_center\">0.20 (0.03)</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"3\"><sup class=\"gt_footnote_marks\">1</sup> Mean (SD)</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nradar_plot(2)\n```\n\n::: {.cell-output-display}\n![](12-explore-clust-props_files/figure-html/rad2-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nprop %>% \n  select(k_2, claytotal, om, ph1to1h2o, caco3) %>% \n  pivot_longer(-k_2) %>% \nggplot() + \n  geom_violin(aes(x = name, y = value, color = k_2)) +\n  facet_wrap(vars(name), scales = \"free\")\n```\n\n::: {.cell-output-display}\n![](12-explore-clust-props_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n## 3 Clusters \"Distinguishing NW?\"\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoord3 <- parcoor_plot(nclust = 3)\nstat3 <- plot_cluster_stats(3)\n\ncoord3 + stat3 + plot_layout(widths = c(2,1), guides = \"collect\")\n```\n\n::: {.cell-output-display}\n![](12-explore-clust-props_files/figure-html/pc3-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nradar_plot(3)\n```\n\n::: {.cell-output-display}\n![](12-explore-clust-props_files/figure-html/rad3-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncreate_summary_table(\"k_3\")\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"ioonuqtvbx\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#ioonuqtvbx .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ioonuqtvbx .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ioonuqtvbx .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ioonuqtvbx .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ioonuqtvbx .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ioonuqtvbx .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ioonuqtvbx .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ioonuqtvbx .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ioonuqtvbx .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ioonuqtvbx .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ioonuqtvbx .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ioonuqtvbx .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ioonuqtvbx .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ioonuqtvbx .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ioonuqtvbx .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ioonuqtvbx .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ioonuqtvbx .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ioonuqtvbx .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ioonuqtvbx .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ioonuqtvbx .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ioonuqtvbx .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ioonuqtvbx .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ioonuqtvbx .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ioonuqtvbx .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ioonuqtvbx .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ioonuqtvbx .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ioonuqtvbx .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ioonuqtvbx .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ioonuqtvbx .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ioonuqtvbx .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ioonuqtvbx .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ioonuqtvbx .gt_left {\n  text-align: left;\n}\n\n#ioonuqtvbx .gt_center {\n  text-align: center;\n}\n\n#ioonuqtvbx .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ioonuqtvbx .gt_font_normal {\n  font-weight: normal;\n}\n\n#ioonuqtvbx .gt_font_bold {\n  font-weight: bold;\n}\n\n#ioonuqtvbx .gt_font_italic {\n  font-style: italic;\n}\n\n#ioonuqtvbx .gt_super {\n  font-size: 65%;\n}\n\n#ioonuqtvbx .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#ioonuqtvbx .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ioonuqtvbx .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ioonuqtvbx .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ioonuqtvbx .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ioonuqtvbx .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ioonuqtvbx .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\">\n  \n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\"><strong>Characteristic</strong></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\"><strong>Cluster_1</strong>, N = 2,084<sup class=\"gt_footnote_marks\">1</sup></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\"><strong>Cluster_2</strong>, N = 2,967<sup class=\"gt_footnote_marks\">1</sup></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\"><strong>Cluster_3</strong>, N = 1,821<sup class=\"gt_footnote_marks\">1</sup></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td class=\"gt_row gt_left\">claytotal</td>\n<td class=\"gt_row gt_center\">9 (4)</td>\n<td class=\"gt_row gt_center\">24 (8)</td>\n<td class=\"gt_row gt_center\">24 (9)</td></tr>\n    <tr><td class=\"gt_row gt_left\">om</td>\n<td class=\"gt_row gt_center\">2.30 (1.21)</td>\n<td class=\"gt_row gt_center\">5.82 (9.79)</td>\n<td class=\"gt_row gt_center\">5.50 (4.01)</td></tr>\n    <tr><td class=\"gt_row gt_left\">cec7</td>\n<td class=\"gt_row gt_center\">10 (4)</td>\n<td class=\"gt_row gt_center\">25 (19)</td>\n<td class=\"gt_row gt_center\">22 (10)</td></tr>\n    <tr><td class=\"gt_row gt_left\">dbthirdbar</td>\n<td class=\"gt_row gt_center\">1.47 (0.10)</td>\n<td class=\"gt_row gt_center\">1.31 (0.18)</td>\n<td class=\"gt_row gt_center\">1.30 (0.18)</td></tr>\n    <tr><td class=\"gt_row gt_left\">ec</td>\n<td class=\"gt_row gt_center\">0.01 (0.12)</td>\n<td class=\"gt_row gt_center\">0.04 (0.20)</td>\n<td class=\"gt_row gt_center\">0.28 (0.60)</td></tr>\n    <tr><td class=\"gt_row gt_left\">ph1to1h2o</td>\n<td class=\"gt_row gt_center\">6.47 (0.49)</td>\n<td class=\"gt_row gt_center\">6.62 (0.36)</td>\n<td class=\"gt_row gt_center\">7.60 (0.30)</td></tr>\n    <tr><td class=\"gt_row gt_left\">caco3</td>\n<td class=\"gt_row gt_center\">0.4 (1.4)</td>\n<td class=\"gt_row gt_center\">0.3 (0.9)</td>\n<td class=\"gt_row gt_center\">9.9 (4.9)</td></tr>\n    <tr><td class=\"gt_row gt_left\">lep</td>\n<td class=\"gt_row gt_center\">1.18 (0.48)</td>\n<td class=\"gt_row gt_center\">2.99 (1.84)</td>\n<td class=\"gt_row gt_center\">2.94 (2.05)</td></tr>\n    <tr><td class=\"gt_row gt_left\">ksat</td>\n<td class=\"gt_row gt_center\">52 (36)</td>\n<td class=\"gt_row gt_center\">9 (6)</td>\n<td class=\"gt_row gt_center\">11 (11)</td></tr>\n    <tr><td class=\"gt_row gt_left\">awc</td>\n<td class=\"gt_row gt_center\">0.13 (0.03)</td>\n<td class=\"gt_row gt_center\">0.21 (0.04)</td>\n<td class=\"gt_row gt_center\">0.19 (0.03)</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"4\"><sup class=\"gt_footnote_marks\">1</sup> Mean (SD)</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n:::\n:::\n\n\n## 4 Clusters\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoord4 <- parcoor_plot(nclust = 4)\nstat4 <- plot_cluster_stats(4)\n\ncoord4 + stat4 + plot_layout(widths = c(2,1), guides = \"collect\")\n```\n\n::: {.cell-output-display}\n![](12-explore-clust-props_files/figure-html/pc4-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nradar_plot(4)\n```\n\n::: {.cell-output-display}\n![](12-explore-clust-props_files/figure-html/rad4-1.png){width=672}\n:::\n:::\n\n\n## 5 Clusters \"EC artefacts? EC-OM-Clay spread\"\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoord5 <- parcoor_plot(nclust = 5)\nstat5 <- plot_cluster_stats(5)\n\ncoord5 + stat5 + plot_layout(widths = c(2,1), guides = \"collect\")\n```\n\n::: {.cell-output-display}\n![](12-explore-clust-props_files/figure-html/pc5-1.png){width=672}\n:::\n:::\n\n\nI wonder if the difference between Cluster 1 and 5 here is actually being driven by the EC values we set to zero in the NW part of the state?\nIt seems to be the only major thing distinguishing those 2 clusters.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nradar_plot(5)\n```\n\n::: {.cell-output-display}\n![](12-explore-clust-props_files/figure-html/rad5-1.png){width=672}\n:::\n:::\n\n\n## 6 Clusters \"Histosols break free\"\n\nWhat strikes me about this one is Cluster 2, it seems like those might be histosols that broke away into their own cluster?\nCluster 2 very high OM, CEC, very low bulk density, high AWC.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoord6 <- parcoor_plot(nclust = 6)\nstat6 <- plot_cluster_stats(6)\n\ncoord6 + stat6 + plot_layout(widths = c(2,1), guides = \"collect\")\n```\n\n::: {.cell-output-display}\n![](12-explore-clust-props_files/figure-html/pc6-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nradar_plot(6)\n```\n\n::: {.cell-output-display}\n![](12-explore-clust-props_files/figure-html/rad6-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncreate_summary_table(\"k_6\")\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"hfwtjwfkkv\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#hfwtjwfkkv .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#hfwtjwfkkv .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#hfwtjwfkkv .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#hfwtjwfkkv .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#hfwtjwfkkv .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hfwtjwfkkv .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#hfwtjwfkkv .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#hfwtjwfkkv .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#hfwtjwfkkv .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#hfwtjwfkkv .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#hfwtjwfkkv .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#hfwtjwfkkv .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#hfwtjwfkkv .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#hfwtjwfkkv .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#hfwtjwfkkv .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#hfwtjwfkkv .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#hfwtjwfkkv .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hfwtjwfkkv .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#hfwtjwfkkv .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#hfwtjwfkkv .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hfwtjwfkkv .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#hfwtjwfkkv .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#hfwtjwfkkv .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hfwtjwfkkv .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hfwtjwfkkv .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#hfwtjwfkkv .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#hfwtjwfkkv .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hfwtjwfkkv .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#hfwtjwfkkv .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hfwtjwfkkv .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#hfwtjwfkkv .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hfwtjwfkkv .gt_left {\n  text-align: left;\n}\n\n#hfwtjwfkkv .gt_center {\n  text-align: center;\n}\n\n#hfwtjwfkkv .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#hfwtjwfkkv .gt_font_normal {\n  font-weight: normal;\n}\n\n#hfwtjwfkkv .gt_font_bold {\n  font-weight: bold;\n}\n\n#hfwtjwfkkv .gt_font_italic {\n  font-style: italic;\n}\n\n#hfwtjwfkkv .gt_super {\n  font-size: 65%;\n}\n\n#hfwtjwfkkv .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#hfwtjwfkkv .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#hfwtjwfkkv .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#hfwtjwfkkv .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#hfwtjwfkkv .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#hfwtjwfkkv .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#hfwtjwfkkv .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\">\n  \n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\"><strong>Characteristic</strong></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\"><strong>Cluster_1</strong>, N = 1,660<sup class=\"gt_footnote_marks\">1</sup></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\"><strong>Cluster_2</strong>, N = 2,276<sup class=\"gt_footnote_marks\">1</sup></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\"><strong>Cluster_3</strong>, N = 1,376<sup class=\"gt_footnote_marks\">1</sup></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\"><strong>Cluster_4</strong>, N = 1,100<sup class=\"gt_footnote_marks\">1</sup></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\"><strong>Cluster_5</strong>, N = 393<sup class=\"gt_footnote_marks\">1</sup></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\"><strong>Cluster_6</strong>, N = 67<sup class=\"gt_footnote_marks\">1</sup></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td class=\"gt_row gt_left\">claytotal</td>\n<td class=\"gt_row gt_center\">9 (3)</td>\n<td class=\"gt_row gt_center\">19 (5)</td>\n<td class=\"gt_row gt_center\">23 (7)</td>\n<td class=\"gt_row gt_center\">34 (7)</td>\n<td class=\"gt_row gt_center\">22 (10)</td>\n<td class=\"gt_row gt_center\">7 (4)</td></tr>\n    <tr><td class=\"gt_row gt_left\">om</td>\n<td class=\"gt_row gt_center\">2.07 (1.11)</td>\n<td class=\"gt_row gt_center\">3.58 (1.63)</td>\n<td class=\"gt_row gt_center\">5.43 (3.13)</td>\n<td class=\"gt_row gt_center\">5.99 (1.87)</td>\n<td class=\"gt_row gt_center\">4.73 (1.38)</td>\n<td class=\"gt_row gt_center\">68.17 (17.64)</td></tr>\n    <tr><td class=\"gt_row gt_left\">cec7</td>\n<td class=\"gt_row gt_center\">9 (3)</td>\n<td class=\"gt_row gt_center\">17 (4)</td>\n<td class=\"gt_row gt_center\">21 (7)</td>\n<td class=\"gt_row gt_center\">29 (6)</td>\n<td class=\"gt_row gt_center\">19 (8)</td>\n<td class=\"gt_row gt_center\">141 (29)</td></tr>\n    <tr><td class=\"gt_row gt_left\">dbthirdbar</td>\n<td class=\"gt_row gt_center\">1.49 (0.09)</td>\n<td class=\"gt_row gt_center\">1.36 (0.08)</td>\n<td class=\"gt_row gt_center\">1.31 (0.20)</td>\n<td class=\"gt_row gt_center\">1.27 (0.12)</td>\n<td class=\"gt_row gt_center\">1.28 (0.09)</td>\n<td class=\"gt_row gt_center\">0.30 (0.22)</td></tr>\n    <tr><td class=\"gt_row gt_left\">ec</td>\n<td class=\"gt_row gt_center\">0.01 (0.09)</td>\n<td class=\"gt_row gt_center\">0.01 (0.07)</td>\n<td class=\"gt_row gt_center\">0.00 (0.00)</td>\n<td class=\"gt_row gt_center\">0.07 (0.26)</td>\n<td class=\"gt_row gt_center\">1.35 (0.56)</td>\n<td class=\"gt_row gt_center\">0.00 (0.00)</td></tr>\n    <tr><td class=\"gt_row gt_left\">ph1to1h2o</td>\n<td class=\"gt_row gt_center\">6.45 (0.50)</td>\n<td class=\"gt_row gt_center\">6.55 (0.35)</td>\n<td class=\"gt_row gt_center\">7.58 (0.30)</td>\n<td class=\"gt_row gt_center\">6.81 (0.38)</td>\n<td class=\"gt_row gt_center\">7.66 (0.37)</td>\n<td class=\"gt_row gt_center\">6.57 (0.47)</td></tr>\n    <tr><td class=\"gt_row gt_left\">caco3</td>\n<td class=\"gt_row gt_center\">0.4 (1.4)</td>\n<td class=\"gt_row gt_center\">0.3 (1.0)</td>\n<td class=\"gt_row gt_center\">10.0 (4.9)</td>\n<td class=\"gt_row gt_center\">0.8 (2.0)</td>\n<td class=\"gt_row gt_center\">9.3 (5.8)</td>\n<td class=\"gt_row gt_center\">1.4 (2.4)</td></tr>\n    <tr><td class=\"gt_row gt_left\">lep</td>\n<td class=\"gt_row gt_center\">1.16 (0.47)</td>\n<td class=\"gt_row gt_center\">1.96 (0.92)</td>\n<td class=\"gt_row gt_center\">2.67 (1.38)</td>\n<td class=\"gt_row gt_center\">5.04 (2.17)</td>\n<td class=\"gt_row gt_center\">2.69 (2.09)</td>\n<td class=\"gt_row gt_center\">0.59 (0.30)</td></tr>\n    <tr><td class=\"gt_row gt_left\">ksat</td>\n<td class=\"gt_row gt_center\">59 (37)</td>\n<td class=\"gt_row gt_center\">13 (8)</td>\n<td class=\"gt_row gt_center\">11 (9)</td>\n<td class=\"gt_row gt_center\">4 (3)</td>\n<td class=\"gt_row gt_center\">15 (16)</td>\n<td class=\"gt_row gt_center\">24 (6)</td></tr>\n    <tr><td class=\"gt_row gt_left\">awc</td>\n<td class=\"gt_row gt_center\">0.12 (0.03)</td>\n<td class=\"gt_row gt_center\">0.20 (0.03)</td>\n<td class=\"gt_row gt_center\">0.20 (0.02)</td>\n<td class=\"gt_row gt_center\">0.19 (0.02)</td>\n<td class=\"gt_row gt_center\">0.19 (0.03)</td>\n<td class=\"gt_row gt_center\">0.39 (0.04)</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"7\"><sup class=\"gt_footnote_marks\">1</sup> Mean (SD)</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n:::\n:::\n\n\n## 7 Clusters\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoord7 <- parcoor_plot(nclust = 7)\nstat7 <- plot_cluster_stats(7)\n\ncoord7 + stat7 + plot_layout(widths = c(2,1), guides = \"collect\")\n```\n\n::: {.cell-output-display}\n![](12-explore-clust-props_files/figure-html/pc7-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nradar_plot(7)\n```\n\n::: {.cell-output-display}\n![](12-explore-clust-props_files/figure-html/rad7-1.png){width=672}\n:::\n:::\n\n\n## 8 Clusters\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoord8 <- parcoor_plot(nclust = 8)\nstat8 <- plot_cluster_stats(8)\n\ncoord8 + stat8 + plot_layout(widths = c(2,1), guides = \"collect\")\n```\n\n::: {.cell-output-display}\n![](12-explore-clust-props_files/figure-html/pc8-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nradar_plot(8)\n```\n\n::: {.cell-output-display}\n![](12-explore-clust-props_files/figure-html/rad8-1.png){width=672}\n:::\n:::\n\n\n## 9 Clusters\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoord9 <- parcoor_plot(nclust = 9)\nstat9 <- plot_cluster_stats(9)\n\ncoord9 + stat9 + plot_layout(widths = c(2,1), guides = \"collect\")\n```\n\n::: {.cell-output-display}\n![](12-explore-clust-props_files/figure-html/pc9-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nradar_plot(9)\n```\n\n::: {.cell-output-display}\n![](12-explore-clust-props_files/figure-html/rad9-1.png){width=672}\n:::\n:::\n\n\n## 10 Clusters\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoord10 <- parcoor_plot(nclust = 10)\nstat10 <- plot_cluster_stats(10)\n\ncoord10 + stat10 + plot_layout(widths = c(2,1), guides = \"collect\")\n```\n\n::: {.cell-output-display}\n![](12-explore-clust-props_files/figure-html/pc10-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nradar_plot(10)\n```\n\n::: {.cell-output-display}\n![](12-explore-clust-props_files/figure-html/rad10-1.png){width=672}\n:::\n:::\n\n\n## 11 Clusters\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoord11 <- parcoor_plot(nclust = 11)\nstat11 <- plot_cluster_stats(11)\n\ncoord11 + stat11 + plot_layout(widths = c(2,1), guides = \"collect\")\n```\n\n::: {.cell-output-display}\n![](12-explore-clust-props_files/figure-html/pc11-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nradar_plot(11)\n```\n\n::: {.cell-output-display}\n![](12-explore-clust-props_files/figure-html/rad11-1.png){width=672}\n:::\n:::\n\n\n## Different plot example\n\nAnother way to compare soil properties between clusters.\nOnly really works with a small number of clusters\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# the centroids are all on a standardized scale,\n# so we can plot all the vars together to compare\n# the properties of each cluster\ncent_df %>%\n  filter(n_clust == 4) %>% \n  select(-n_clust) %>% \n  pivot_longer(cols = -.cluster,\n               names_to = 'variable',\n               values_to = 'value') %>%\n  ggplot() +\n  geom_col(aes(x = value, y = variable)) +\n  facet_wrap(vars(.cluster), nrow = 1) +\n  geom_vline(xintercept = 0, color = \"blue\") +\n  expand_limits(y = 13.5) +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](12-explore-clust-props_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# +\n#   geom_label(data = clust_stat,\n#              aes(\n#                x = 0.25,\n#                y = 11.5,\n#                label = glue(\"n:{n_members}\")\n#              ),\n#              size = 2.5) +\n#   geom_label(data = clust_stat,\n#              aes(\n#                x = 0.25,\n#                y = 12.5,\n#                label = glue(\"wss:{round(wss,0)}\")\n#              ),\n#              size = 2.5) +\n#   theme_bw() \n```\n:::\n\n::: {.cell}\n\n:::\n",
    "supporting": [
      "12-explore-clust-props_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}